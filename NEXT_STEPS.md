# âœ… GitHub Actions ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð”ÐµÐ¿Ð»Ð¾Ð¹ â€” Ð§Ñ‚Ð¾ Ð”ÐµÐ»Ð°Ñ‚ÑŒ Ð”Ð°Ð»ÑŒÑˆÐµ

## ðŸ“‹ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ

Ð’ÑÑ‘ Ð³Ð¾Ñ‚Ð¾Ð²Ð¾! Workflow Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹. ÐžÑÑ‚Ð°Ð»Ð¾ÑÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ SSH Ð¸ GitHub Secrets.

## ðŸš€ ÐŸÐ¾ÑˆÐ°Ð³Ð¾Ð²Ð°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ

### Ð¨Ð°Ð³ 1: ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° SSH-ÐºÐ»ÑŽÑ‡Ð° (Ð½Ð° Ñ‚Ð²Ð¾Ñ‘Ð¼ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ðµ)

ÐžÑ‚ÐºÑ€Ð¾Ð¹ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð» Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸:

```bash
ssh-keygen -t ed25519 -f ~/github_deploy -N ""
```

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ÑÐ¾Ð·Ð´Ð°Ð´ÑƒÑ‚ÑÑ Ð´Ð²Ð° Ñ„Ð°Ð¹Ð»Ð° Ð² Ð´Ð¾Ð¼Ð°ÑˆÐ½ÐµÐ¹ Ð¿Ð°Ð¿ÐºÐµ:
- `github_deploy` (Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡) â€” Ñ…Ñ€Ð°Ð½Ð¸ Ð² ÑÐµÐºÑ€ÐµÑ‚Ðµ!
- `github_deploy.pub` (Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡) â€” Ð·Ð°Ð»Ð¸Ð²Ð°ÐµÑˆÑŒ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€

### Ð¨Ð°Ð³ 2: Ð”Ð¾Ð±Ð°Ð²ÑŒ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Beget/VPS

#### Ð”Ð»Ñ Beget:
1. Ð›Ð¾Ð³Ð¸Ð½ÑŒÑÑ Ð¿Ð¾ SSH (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ðµ ÑƒÑ‡Ñ‘Ñ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ)
   ```bash
   ssh user@login.beget.tech
   ```
2. Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸:
   ```bash
   cat >> ~/.ssh/authorized_keys << 'EOF'
   ```
   Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ `github_deploy.pub` Ð¸ Ð²ÑÑ‚Ð°Ð²ÑŒ
   ```bash
   EOF
   chmod 600 ~/.ssh/authorized_keys
   chmod 700 ~/.ssh
   ```

#### Ð”Ð»Ñ VPS (Ubuntu/Debian):
```bash
# ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ
cat >> ~/.ssh/authorized_keys << 'EOF'
# Ð²ÑÑ‚Ð°Ð²ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ github_deploy.pub
EOF

chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

### Ð¨Ð°Ð³ 3: Ð”Ð¾Ð±Ð°Ð²ÑŒ GitHub Secrets

1. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸ Ð² Ñ€ÐµÐ¿Ð¾ â†’ **Settings** â†’ **Secrets and variables** â†’ **Actions**
2. ÐÐ°Ð¶Ð¼Ð¸ **New repository secret** Ð¸ ÑÐ¾Ð·Ð´Ð°Ð¹ 4 secret:

#### Secret 1: `SSH_PRIVATE_KEY`
- Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ„Ð°Ð¹Ð»Ð° `github_deploy`
- ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ñ: `-----BEGIN OPENSSH PRIVATE KEY-----`
- Ð—Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð°: `-----END OPENSSH PRIVATE KEY-----`

#### Secret 2: `SSH_HOST`
- Ð”Ð»Ñ Beget: `login.beget.tech`
- Ð”Ð»Ñ VPS: IP ÑÐµÑ€Ð²ÐµÑ€Ð° Ð¸Ð»Ð¸ Ð´Ð¾Ð¼ÐµÐ½ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `example.com` Ð¸Ð»Ð¸ `123.45.67.89`)

#### Secret 3: `SSH_USER`
- Ð›Ð¾Ð³Ð¸Ð½ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ
- Ð”Ð»Ñ Beget: Ð»Ð¾Ð³Ð¸Ð½ Ð¾Ñ‚ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°
- Ð”Ð»Ñ VPS: `root`, `ubuntu`, Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ SSH Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð¾Ð¼

#### Secret 4: `SSH_TARGET`
- **Ð’ÐÐ–ÐÐž:** ÐŸÐ°Ð¿ÐºÐ° Ð´Ð¾Ð»Ð¶Ð½Ð° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ!
- Ð”Ð»Ñ Beget: `/home/username/domain.ru/public_html`
- Ð”Ð»Ñ VPS: `/var/www/ai-fitting-room` Ð¸Ð»Ð¸ Ð»ÑŽÐ±Ð¾Ð¹ Ð¿ÑƒÑ‚ÑŒ Ð³Ð´Ðµ Ð¶Ð¸Ð²Ñ‘Ñ‚ ÑÐ°Ð¹Ñ‚

Ð•ÑÐ»Ð¸ Ð¿Ð°Ð¿ÐºÐ° Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚, ÑÐ¾Ð·Ð´Ð°Ð¹ ÐµÑ‘:
```bash
ssh user@host
mkdir -p /path/to/target
exit
```

### Ð¨Ð°Ð³ 4: ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐ¹ Ð´ÐµÐ¿Ð»Ð¾Ð¹

1. Ð¡Ð´ÐµÐ»Ð°Ð¹ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð² Ñ€ÐµÐ¿Ð¾ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð´Ð¾Ð±Ð°Ð²ÑŒ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ð² HTML)
2. Ð—Ð°ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¸ Ð¸ Ð¿ÑƒÑˆÐ½Ð¸:
   ```bash
   git add .
   git commit -m "test: trigger deploy"
   git push
   ```
3. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸ Ð² Ñ€ÐµÐ¿Ð¾ â†’ **Actions** â†’ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ Ð»Ð¾Ð³Ð¸ workflow'Ð° **Deploy to Server**
4. Ð•ÑÐ»Ð¸ âœ… **Success** â†’ Ñ„Ð°Ð¹Ð»Ñ‹ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€!
5. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ: `ls -la /path/to/target` â€” Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ñ‚Ð²Ð¾Ð¸ Ñ„Ð°Ð¹Ð»Ñ‹

## ðŸ› Ð ÐµÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼

### âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: `Permission denied (publickey)`

**ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:** ÐŸÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² `authorized_keys` Ð¸Ð»Ð¸ Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð°.

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
```bash
# ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ
cat ~/.ssh/authorized_keys  # Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒ, ÐµÑÑ‚ÑŒ Ð»Ð¸ Ñ‚Ð°Ð¼ ÐºÐ»ÑŽÑ‡
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

### âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: `rsync: [receiver] mkdir failed on ...`

**ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:** Ð¦ÐµÐ»ÐµÐ²Ð°Ñ Ð¿Ð°Ð¿ÐºÐ° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚.

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
```bash
ssh user@host
mkdir -p /path/to/target
```

### âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: `Host key verification failed`

**ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:** Ð¡ÐµÑ€Ð²ÐµÑ€ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ñ€Ð°Ð·, Ð½ÑƒÐ¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² `known_hosts`.

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** Workflow Ð´ÐµÐ»Ð°ÐµÑ‚ ÑÑ‚Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸, Ð½Ð¾ ÐµÑÐ»Ð¸ Ð½Ðµ Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ â€” Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒ `SSH_HOST`.

### âŒ Actions Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð¿ÑƒÑˆÐµ

**ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ:**
1. Ð§Ñ‚Ð¾ Ð¿ÑƒÑˆÐ¸ÑˆÑŒ Ð² Ð²ÐµÑ‚ÐºÑƒ `main` (Ð² workflow Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€: `branches: [ main ]`)
2. Ð§Ñ‚Ð¾ Ñ€ÐµÐ¿Ð¾ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¸Ð»Ð¸ workflow Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð² Settings
3. ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ Ð² Actions â†’ Ð²ÑÐµ Ð»Ð¸ workflow'Ñ‹ Ð²Ð¸Ð´Ð½Ñ‹

## ðŸ“Š Ð§Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð¿Ñ€Ð¸ Ð´ÐµÐ¿Ð»Ð¾Ðµ

ÐšÐ¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð¿ÑƒÑˆÐ¸ÑˆÑŒ Ð² `main`:

1. âœ… GitHub Actions Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ workflow
2. âœ… Checkout'Ð¸Ñ‚ ÐºÐ¾Ð´
3. âœ… Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ SSH-Ð°Ð³ÐµÐ½Ñ‚ Ñ Ñ‚Ð²Ð¾Ð¸Ð¼ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ð¼ ÐºÐ»ÑŽÑ‡Ð¾Ð¼
4. âœ… Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ñ…Ð¾ÑÑ‚ Ð² `known_hosts`
5. âœ… **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ SSH-Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ** (5 ÑÐµÐº Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚)
6. âœ… Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ Ñ„Ð°Ð¹Ð»Ñ‹ Ñ‡ÐµÑ€ÐµÐ· rsync
   - ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÑ‚ Ð²ÑÐµ Ñ„Ð°Ð¹Ð»Ñ‹
   - Ð˜ÑÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚: `.git`, `.github`, `.gitignore`, `*.md`, `node_modules`
   - Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð½ÐµÑ‚ Ð² Ð½Ð¾Ð²Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸
7. âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ð½Ð¾Ð²Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ

## ðŸ“ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾

**GitHub Pages** Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ Ð²ÐºÐ»ÑŽÑ‡Ñ‘Ð½Ð½Ñ‹Ð¼ Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾.

**Ð”Ð²Ð° Ð´ÐµÐ¿Ð»Ð¾Ñ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾:**
- GitHub Pages: ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ñ…Ð¾ÑÑ‚Ð¸Ð½Ð³ Ð½Ð° GitHub (Ð±Ñ‹ÑÑ‚Ñ€Ð¾, Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)
- Ð¢Ð²Ð¾Ð¹ ÑÐµÑ€Ð²ÐµÑ€ (Beget/VPS): Ñ‡ÐµÑ€ÐµÐ· SSH+rsync

## ðŸŽ¯ Ð“Ð¾Ñ‚Ð¾Ð²Ð¾!

ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÑÑ‚Ð¸Ñ… ÑˆÐ°Ð³Ð¾Ð²:
- ÐŸÑ€Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð¼ `git push` Ð² `main` â†’ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€
- GitHub Actions Ð»Ð¾Ð³Ð¸Ñ€ÑƒÐµÑ‚ Ð²ÑÐµ ÑˆÐ°Ð³Ð¸
- ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð²Ð¸Ð´Ð½Ñ‹ Ð² Actions â†’ Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑˆÑŒ workflow â†’ ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ÑˆÑŒ Ð»Ð¾Ð³

**Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹?** ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒ DEPLOY_SETUP.md Ð´Ð»Ñ Ð±Ð¾Ð»ÐµÐµ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸.

---

**ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÐµÐµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ:** Dec 19, 2025

**Workflow Ñ„Ð°Ð¹Ð»:** `.github/workflows/deploy-server.yml`
